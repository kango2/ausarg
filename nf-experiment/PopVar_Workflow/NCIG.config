/**
 * Nextflow Configuration Script for Genomic Data Analysis
 * 
 * This configuration script defines execution profiles for the Nextflow pipeline, 
 * setting up specific resources and parameters for running the pipeline on 
 * different computing environments: locally, on the NCI HPC cluster, and an `ignitenode` cluster.
 * 
 * The configurations specify resource requirements for different processes/modules
 * of the pipeline, ensuring optimal and efficient execution.
 *
 * Authors: Kosar Hooshmand
 */

profiles {
  NCI {
    process {
      // Set Executor
      executor = 'pbspronci'
      project = 'te53'
      storage = 'scratch/te53+gdata/te53+gdata/xy86+gdata/if89'
      
      withLabel: bwa_mem {
        cpus = 16
        memory = '64.GB'
      }

      withLabel: sort_markdup {
        cpus = 16
        memory = '64.GB'
      }

      withLabel: baserecalibrator {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: applyBQSR {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: haplotypecaller {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: combineGVCFs_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: combineGVCFs_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: genotypeGVCFs_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: genotypeGVCFs_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantrecalibrator_SNP_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantrecalibrator_SNP_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantrecalibrator_INDEL_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantrecalibrator_INDEL_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: applyVQSR_SNP_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: applyVQSR_SNP_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: applyVQSR_INDEL_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: applyVQSR_INDEL_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantannotator_SNP_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantannotator_SNP_female {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantannotator_INDEL_male {
        cpus = 8
        memory = '32.GB'
      }

      withLabel: variantannotator_INDEL_female {
        cpus = 8
        memory = '32.GB'
      }
    }
      local {
    process {
      executor = 'local'
    }
  }
  ignitenode {
    cluster {
      maxCpus = 240
      maxMemory = 190.GB
      maxDisk = 400.GB
    }
  }
    config {
      // Enable DSL 2.0 syntax
      enable.dsl = 2
    }
  }
}
params {

  out_dir = "/g/data/te53/kh3349/Nextflow_project/Test_project/NCIG_Population_Project/GIAB-hg004/execution"
}

timeline {
  enabled = true
  file = "${params.out_dir}/timeline.html"
  overwrite = true
}
report {
  enabled = true
  file = "${params.out_dir}/report.html"
  overwrite = true
}
trace {
  enabled = true
  file = "${params.out_dir}/trace.txt"
  overwrite = true
}
dag {
  enabled = true
  file = "${params.out_dir}/flowchart.png"
  overwrite = true
}
